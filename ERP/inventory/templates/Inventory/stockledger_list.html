{% extends "components/base/list_base.html" %}
{% load static %}

{% block title %}Stock Ledger{% endblock %}
{% block list_page_title %}Stock Ledger{% endblock %}
{% block list_title %}Stock Ledger History{% endblock %}

{% block list_actions %}
  <div class="d-flex flex-wrap gap-2">
    <a href="{% url 'inventory:stock_report' %}" class="btn btn-outline-secondary btn-sm">
      <i class="mdi mdi-chart-box"></i> Stock Report
    </a>
  </div>
{% endblock %}

{% block table_head %}
  <tr>
    <th>Date</th>
    <th>Type</th>
    <th>Reference</th>
    <th>Product</th>
    <th>Warehouse</th>
    <th>Location</th>
    <th class="text-end">Qty In</th>
    <th class="text-end">Qty Out</th>
    <th class="text-end">Unit Cost</th>
    <th style="width:120px;">Actions</th>
  </tr>
{% endblock %}

{% block table_body %}
  {% for entry in object_list %}
    <tr>
      <td>{{ entry.txn_date|date:"SHORT_DATE_FORMAT" }}</td>
      <td>
        {% if entry.txn_type == 'IN' %}
          <span class="badge bg-success">IN</span>
        {% elif entry.txn_type == 'OUT' %}
          <span class="badge bg-danger">OUT</span>
        {% elif entry.txn_type == 'TRANSFER' %}
          <span class="badge bg-info">TRANSFER</span>
        {% else %}
          <span class="badge bg-light text-dark">{{ entry.get_txn_type_display }}</span>
        {% endif %}
      </td>
      <td class="fw-semibold">{{ entry.reference_id|default:"—" }}</td>
      <td>{{ entry.product.code }} - {{ entry.product.name }}</td>
      <td>{{ entry.warehouse.code }}</td>
      <td>{{ entry.location.code|default:"N/A" }}</td>
      <td class="text-end">
        {% if entry.qty_in %}
          <span class="text-success">{{ entry.qty_in }}</span>
        {% else %}
          —
        {% endif %}
      </td>
      <td class="text-end">
        {% if entry.qty_out %}
          <span class="text-danger">{{ entry.qty_out }}</span>
        {% else %}
          —
        {% endif %}
      </td>
      <td class="text-end">{{ entry.unit_cost|default:"0" }}</td>
      <td>
        <div class="btn-group btn-group-sm" role="group">
          <a href="{% url 'inventory:stockledger_detail' entry.pk %}" class="btn btn-outline-info">View</a>
        </div>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="10" class="text-center text-muted py-3">No ledger entries found.</td></tr>
  {% endfor %}
{% endblock %}
