# Generated by Django 4.2.26 on 2025-11-14 16:48

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('usermanagement', '0022_alter_permission_action'),
        ('accounting', '0116_alter_fiscalyear_id'),
    ]

    operations = [
        migrations.CreateModel(
            name='Customer',
            fields=[
                ('customer_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=30)),
                ('display_name', models.CharField(max_length=255)),
                ('legal_name', models.CharField(blank=True, max_length=255)),
                ('status', models.CharField(choices=[('active', 'Active'), ('prospect', 'Prospect'), ('on_hold', 'On Hold'), ('inactive', 'Inactive')], default='active', max_length=20)),
                ('tax_id', models.CharField(blank=True, max_length=50)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone_number', models.CharField(blank=True, max_length=50)),
                ('website', models.URLField(blank=True)),
                ('credit_limit', models.DecimalField(blank=True, decimal_places=4, max_digits=19, null=True)),
                ('credit_rating', models.CharField(blank=True, max_length=20)),
                ('credit_review_at', models.DateField(blank=True, null=True)),
                ('on_credit_hold', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('accounts_receivable_account', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='customers_ar_account', to='accounting.chartofaccount')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_customers', to=settings.AUTH_USER_MODEL)),
                ('default_currency', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='customer_currency', to='accounting.currency')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='customers', to='usermanagement.organization')),
            ],
            options={
                'db_table': 'customer',
                'ordering': ('display_name',),
            },
        ),
        migrations.CreateModel(
            name='Dimension',
            fields=[
                ('dimension_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=30)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('dimension_type', models.CharField(choices=[('cost_center', 'Cost Center'), ('department', 'Department'), ('project', 'Project'), ('custom', 'Custom')], default='custom', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_dimensions', to=settings.AUTH_USER_MODEL)),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='dimensions', to='usermanagement.organization')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_dimensions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'dimension',
                'ordering': ('name',),
            },
        ),
        migrations.CreateModel(
            name='DimensionValue',
            fields=[
                ('dimension_value_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=30)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('dimension', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='values', to='accounting.dimension')),
            ],
            options={
                'db_table': 'dimension_value',
                'ordering': ('dimension', 'code'),
            },
        ),
        migrations.CreateModel(
            name='PaymentTerm',
            fields=[
                ('payment_term_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=20)),
                ('name', models.CharField(max_length=100)),
                ('term_type', models.CharField(choices=[('ap', 'Accounts Payable'), ('ar', 'Accounts Receivable'), ('both', 'Both')], default='both', max_length=10)),
                ('description', models.TextField(blank=True)),
                ('net_due_days', models.PositiveIntegerField(default=30, help_text='Number of days from invoice date to calculate the due date.', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(365)])),
                ('discount_percent', models.DecimalField(decimal_places=2, default=0, help_text='Early-payment discount percentage (e.g. 2.00 for 2%).', max_digits=5)),
                ('discount_days', models.PositiveIntegerField(blank=True, help_text='Number of days to qualify for the discount.', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_payment_terms', to=settings.AUTH_USER_MODEL)),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payment_terms', to='usermanagement.organization')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_payment_terms', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'payment_term',
                'ordering': ('name',),
                'unique_together': {('organization', 'code')},
            },
        ),
        migrations.CreateModel(
            name='Vendor',
            fields=[
                ('vendor_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=30)),
                ('display_name', models.CharField(max_length=255)),
                ('legal_name', models.CharField(blank=True, max_length=255)),
                ('status', models.CharField(choices=[('active', 'Active'), ('on_hold', 'On Hold'), ('inactive', 'Inactive')], default='active', max_length=20)),
                ('tax_id', models.CharField(blank=True, max_length=50)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone_number', models.CharField(blank=True, max_length=50)),
                ('website', models.URLField(blank=True)),
                ('notes', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('credit_limit', models.DecimalField(blank=True, decimal_places=4, max_digits=19, null=True)),
                ('on_hold', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('accounts_payable_account', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='vendors_ap_account', to='accounting.chartofaccount')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_vendors', to=settings.AUTH_USER_MODEL)),
                ('default_currency', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='vendor_currency', to='accounting.currency')),
                ('expense_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='vendors_expense_account', to='accounting.chartofaccount')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='vendors', to='usermanagement.organization')),
                ('payment_term', models.ForeignKey(blank=True, limit_choices_to={'term_type__in': ['ap', 'both']}, null=True, on_delete=django.db.models.deletion.SET_NULL, to='accounting.paymentterm')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_vendors', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'vendor',
                'ordering': ('display_name',),
                'unique_together': {('organization', 'code')},
            },
        ),
        migrations.AlterField(
            model_name='fiscalyear',
            name='id',
            field=models.CharField(default='7313404827', editable=False, max_length=10, unique=True),
        ),
        migrations.CreateModel(
            name='JournalLineDimension',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('allocation_percent', models.DecimalField(blank=True, decimal_places=3, help_text='Optional allocation weighting for reporting (0-100).', max_digits=6, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('dimension', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='dimension_assignments', to='accounting.dimension')),
                ('dimension_value', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='dimension_assignments', to='accounting.dimensionvalue')),
                ('journal_line', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='dimension_assignments', to='accounting.journalline')),
            ],
            options={
                'db_table': 'journal_line_dimension',
            },
        ),
        migrations.CreateModel(
            name='CustomerContact',
            fields=[
                ('contact_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=50)),
                ('mobile', models.CharField(blank=True, max_length=50)),
                ('job_title', models.CharField(blank=True, max_length=100)),
                ('is_primary', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('customer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contacts', to='accounting.customer')),
            ],
            options={
                'db_table': 'customer_contact',
            },
        ),
        migrations.CreateModel(
            name='CustomerBankAccount',
            fields=[
                ('bank_account_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('bank_name', models.CharField(max_length=255)),
                ('account_name', models.CharField(max_length=255)),
                ('account_number', models.CharField(max_length=50)),
                ('routing_number', models.CharField(blank=True, max_length=50)),
                ('swift_code', models.CharField(blank=True, max_length=20)),
                ('iban', models.CharField(blank=True, max_length=34)),
                ('is_primary', models.BooleanField(default=False)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('currency', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='customer_bank_currency', to='accounting.currency')),
                ('customer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bank_accounts', to='accounting.customer')),
            ],
            options={
                'db_table': 'customer_bank_account',
            },
        ),
        migrations.CreateModel(
            name='CustomerAddress',
            fields=[
                ('address_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('address_type', models.CharField(default='billing', max_length=20)),
                ('line1', models.CharField(max_length=255)),
                ('line2', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state_province', models.CharField(blank=True, max_length=100)),
                ('postal_code', models.CharField(blank=True, max_length=20)),
                ('country_code', models.CharField(default='US', max_length=2)),
                ('is_primary', models.BooleanField(default=False)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('customer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='addresses', to='accounting.customer')),
            ],
            options={
                'db_table': 'customer_address',
            },
        ),
        migrations.AddField(
            model_name='customer',
            name='payment_term',
            field=models.ForeignKey(blank=True, limit_choices_to={'term_type__in': ['ar', 'both']}, null=True, on_delete=django.db.models.deletion.SET_NULL, to='accounting.paymentterm'),
        ),
        migrations.AddField(
            model_name='customer',
            name='revenue_account',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='customers_revenue_account', to='accounting.chartofaccount'),
        ),
        migrations.AddField(
            model_name='customer',
            name='updated_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_customers', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='journalline',
            name='dimensions',
            field=models.ManyToManyField(blank=True, related_name='journal_lines', through='accounting.JournalLineDimension', to='accounting.dimensionvalue'),
        ),
        migrations.CreateModel(
            name='VendorContact',
            fields=[
                ('contact_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=50)),
                ('mobile', models.CharField(blank=True, max_length=50)),
                ('job_title', models.CharField(blank=True, max_length=100)),
                ('is_primary', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('vendor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contacts', to='accounting.vendor')),
            ],
            options={
                'db_table': 'vendor_contact',
                'indexes': [models.Index(fields=['vendor', 'is_primary'], name='vendor_cont_vendor__77846a_idx')],
            },
        ),
        migrations.CreateModel(
            name='VendorBankAccount',
            fields=[
                ('bank_account_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('bank_name', models.CharField(max_length=255)),
                ('account_name', models.CharField(max_length=255)),
                ('account_number', models.CharField(max_length=50)),
                ('routing_number', models.CharField(blank=True, max_length=50)),
                ('swift_code', models.CharField(blank=True, max_length=20)),
                ('iban', models.CharField(blank=True, max_length=34)),
                ('is_primary', models.BooleanField(default=False)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('currency', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='vendor_bank_currency', to='accounting.currency')),
                ('vendor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bank_accounts', to='accounting.vendor')),
            ],
            options={
                'db_table': 'vendor_bank_account',
                'indexes': [models.Index(fields=['vendor', 'is_primary'], name='vendor_bank_vendor__179dfc_idx')],
            },
        ),
        migrations.CreateModel(
            name='VendorAddress',
            fields=[
                ('address_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('address_type', models.CharField(choices=[('billing', 'Billing'), ('shipping', 'Shipping'), ('remit', 'Remittance'), ('other', 'Other')], default='billing', max_length=20)),
                ('line1', models.CharField(max_length=255)),
                ('line2', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state_province', models.CharField(blank=True, max_length=100)),
                ('postal_code', models.CharField(blank=True, max_length=20)),
                ('country_code', models.CharField(default='US', max_length=2)),
                ('is_primary', models.BooleanField(default=False)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('vendor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='addresses', to='accounting.vendor')),
            ],
            options={
                'db_table': 'vendor_address',
                'indexes': [models.Index(fields=['vendor', 'address_type'], name='vendor_addr_vendor__cc905a_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='journallinedimension',
            index=models.Index(fields=['journal_line', 'dimension'], name='journal_lin_journal_4436d7_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='journallinedimension',
            unique_together={('journal_line', 'dimension')},
        ),
        migrations.AlterUniqueTogether(
            name='dimensionvalue',
            unique_together={('dimension', 'code')},
        ),
        migrations.AlterUniqueTogether(
            name='dimension',
            unique_together={('organization', 'code')},
        ),
        migrations.AddIndex(
            model_name='customercontact',
            index=models.Index(fields=['customer', 'is_primary'], name='customer_co_custome_e90a8c_idx'),
        ),
        migrations.AddIndex(
            model_name='customerbankaccount',
            index=models.Index(fields=['customer', 'is_primary'], name='customer_ba_custome_38abca_idx'),
        ),
        migrations.AddIndex(
            model_name='customeraddress',
            index=models.Index(fields=['customer', 'address_type'], name='customer_ad_custome_ff86f4_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='customer',
            unique_together={('organization', 'code')},
        ),
    ]
