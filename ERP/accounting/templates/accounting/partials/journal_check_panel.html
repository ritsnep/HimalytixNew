{% load json_filters %}

{% if validation_errors %}
    <ul class="list-group list-group-flush">
        {% if validation_errors.header %}
            {% for field, errors_json in validation_errors.header.items %}
                {% for error in errors_json|json_parse %}
                    <li class="list-group-item list-group-item-danger d-flex justify-content-between align-items-center">
                        Header - {{ field }}: {{ error }}
                        <span class="badge bg-danger rounded-pill">Header</span>
                    </li>
                {% endfor %}
            {% endfor %}
        {% endif %}

        {% if validation_errors.lines %}
            {% for line_index, line_errors_json in validation_errors.lines.items %}
                {% for field, errors in line_errors_json|json_parse %}
                    {% for error in errors %}
                        <li class="list-group-item list-group-item-warning d-flex justify-content-between align-items-center">
                            Line {{ line_index|add:1 }} - {{ field }}: {{ error }}
                            <span class="badge bg-warning text-dark rounded-pill">Line</span>
                        </li>
                    {% endfor %}
                {% endfor %}
            {% endfor %}
        {% endif %}

        {% if validation_errors.non_form_errors %}
            {% for error in validation_errors.non_form_errors|json_parse %}
                <li class="list-group-item list-group-item-danger d-flex justify-content-between align-items-center">
                    General: {{ error }}
                    <span class="badge bg-danger rounded-pill">General</span>
                </li>
            {% endfor %}
        {% endif %}

        {% if validation_errors.journal_date %}
            {% for error in validation_errors.journal_date %}
                <li class="list-group-item list-group-item-danger d-flex justify-content-between align-items-center">
                    Journal Date: {{ error }}
                    <span class="badge bg-danger rounded-pill">Date Guardrail</span>
                </li>
            {% endfor %}
        {% endif %}

        {% if validation_errors.general %}
            {% for error in validation_errors.general %}
                <li class="list-group-item list-group-item-danger d-flex justify-content-between align-items-center">
                    General: {{ error }}
                    <span class="badge bg-danger rounded-pill">General</span>
                </li>
            {% endfor %}
        {% endif %}
    </ul>
{% else %}
    <div class="text-center text-muted p-3">
        <i class="fas fa-check-circle text-success fa-2x mb-2"></i>
        <p>No errors detected.</p>
    </div>
{% endif %}