{% load widget_tweaks %}
<tr class="generic-line-row" data-line-index="{{ index }}" id="line-{{ index }}">
    <td class="text-center text-muted small sticky-col line-number-cell">{{ index|add:1 }}</td>
    {% for field in form.visible_fields %}
        <td class="generic-grid-cell">
            {% with widget_name=field|widget_type %}
                {% if widget_name == "CheckboxInput" %}
                    <div class="form-check m-0">
                        {{ field|add_class:"form-check-input grid-cell" }}
                    </div>
                {% elif widget_name == "DualCalendarWidget" %}
                    <div class="dual-calendar-wrapper">
                        {{ field }}
                    </div>
                {% else %}
                    {% if widget_name == "Select" or widget_name == "SelectMultiple" %}
                        {{ field|add_class:"form-select form-select-sm grid-cell" }}
                    {% else %}
                        {{ field|add_class:"form-control form-control-sm grid-cell" }}
                    {% endif %}
                {% endif %}
            {% endwith %}
            {% if field.errors %}
                <div class="invalid-feedback d-block">
                    {{ field.errors|join:", " }}
                </div>
            {% endif %}
        </td>
    {% endfor %}
    <td class="text-center action-col">
        <button type="button" class="btn btn-sm btn-outline-danger remove-line-btn" title="Remove row">
            <i class="fas fa-times"></i>
        </button>
        {% if form.non_field_errors %}
            <div class="small text-danger mt-1">{{ form.non_field_errors|join:", " }}</div>
        {% endif %}
        {% for hidden in form.hidden_fields %}
            {{ hidden }}
        {% endfor %}
    </td>
</tr>
