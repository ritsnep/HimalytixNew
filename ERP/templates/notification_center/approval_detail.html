{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">{{ approval.title }}</h2>
  <p class="text-muted mb-1">Status: <strong>{{ approval.get_status_display }}</strong></p>
  <p class="text-muted mb-3">Requested at {{ approval.created_at }}</p>

  {% if approval.message %}
    <div class="alert alert-info">{{ approval.message }}</div>
  {% endif %}

  {% if metadata %}
    <div class="card mb-3">
      <div class="card-header">Details</div>
      <div class="card-body">
        <pre class="mb-0">{{ metadata|json_script:"approval_metadata" }}</pre>
      </div>
    </div>
  {% endif %}

  {% if can_act and approval.is_open %}
    <form method="post" action="{% url 'notification_center:approval_decision' approval.pk %}" class="mb-3">
      {% csrf_token %}
      <div class="mb-3">
        <label for="notes" class="form-label">Decision notes (optional)</label>
        <textarea name="notes" id="notes" class="form-control" rows="3"></textarea>
      </div>
      <button type="submit" name="decision" value="approve" class="btn btn-success me-2">Approve</button>
      <button type="submit" name="decision" value="reject" class="btn btn-danger">Reject</button>
    </form>
  {% else %}
    <div class="alert alert-secondary">No further action required.</div>
  {% endif %}

  {% if approval.decision_notes %}
    <p><strong>Decision notes:</strong> {{ approval.decision_notes }}</p>
  {% endif %}
  {% if approval.decided_at %}
    <p><strong>Decided at:</strong> {{ approval.decided_at }}</p>
  {% endif %}
</div>
{% endblock %}
