{% extends 'accounting/_list_base.html' %}

{% block title %}{{ page_title|default:"Goods Receipts" }}{% endblock %}

{% block table_head %}
<thead>
  <tr>
    <th style="width: 140px;">GR #</th>
    <th>PO</th>
    <th>Warehouse</th>
    <th>Receipt Date</th>
    <th>Status</th>
    <th class="text-end" style="width: 140px;">Actions</th>
  </tr>
</thead>
{% endblock table_head %}

{% block custom_filters %}
<form class="row g-2 align-items-end mb-2" method="get">
  <div class="col-sm-4">
    <label class="form-label visually-hidden" for="gr-search">Search</label>
    <input id="gr-search" type="search" name="search" class="form-control form-control-sm" placeholder="Search GR or PO #" value="{{ request.GET.search|default:'' }}">
  </div>
  <div class="col-sm-3">
    <label class="form-label visually-hidden" for="gr-status">Status</label>
    <select id="gr-status" name="status" class="form-select form-select-sm">
      <option value="">All statuses</option>
      {% for value, label in status_choices %}
      <option value="{{ value }}" {% if request.GET.status == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-outline-secondary btn-sm" type="submit">Filter</button>
  </div>
</form>
{% endblock custom_filters %}

{% block table_body %}
<tbody>
  {% for gr in grs %}
  <tr>
    <td class="fw-semibold">{{ gr.number|default:gr.pk }}</td>
    <td>{{ gr.purchase_order.number }}</td>
    <td>{{ gr.warehouse.name }}</td>
    <td>{{ gr.receipt_date }}</td>
    <td><span class="badge bg-light text-dark text-uppercase">{{ gr.get_status_display }}</span></td>
    <td class="text-end">
      <div class="btn-group btn-group-sm">
        <a href="{% url 'purchasing:gr_detail' gr.pk %}" class="btn btn-light">View</a>
        {% if gr.status == gr.Status.DRAFT %}
        <a href="{% url 'purchasing:gr_edit' gr.pk %}" class="btn btn-outline-secondary">Edit</a>
        {% else %}
        <span class="btn btn-outline-success disabled">Posted</span>
        {% endif %}
      </div>
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="5" class="text-center text-muted py-3">No goods receipts found.</td>
  </tr>
  {% endfor %}
</tbody>
{% endblock table_body %}
