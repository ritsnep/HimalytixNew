{% if messages %}
  <div class="mb-2">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} mb-1">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %}
<div class="row">
  <div class="col-lg-5">
    <div class="card">
      <div class="card-header"><h5 class="mb-0">Create NOC Purchase</h5></div>
      <div class="card-body">
        <form hx-post="{% url 'lpg_vertical:spa_noc' %}" hx-target="#lpg-spa-body" hx-swap="innerHTML transition:true" class="row g-2">
          <input type="hidden" name="form_name" value="noc">
          {% csrf_token %}
          {{ form.non_field_errors }}
          <div class="col-md-6">{{ form.bill_no.label_tag }} {{ form.bill_no }}</div>
          <div class="col-md-6">{{ form.date.label_tag }} {{ form.date }}</div>
          <div class="col-md-6">{{ form.quantity_mt.label_tag }} {{ form.quantity_mt }}</div>
          <div class="col-md-6">{{ form.rate_per_mt.label_tag }} {{ form.rate_per_mt }}</div>
          <div class="col-md-6">{{ form.transport_cost.label_tag }} {{ form.transport_cost }}</div>
          <div class="col-md-6">{{ form.tax_amount.label_tag }} {{ form.tax_amount }}</div>
          <div class="col-12">{{ form.receipt_location.label_tag }} {{ form.receipt_location }}</div>
          <div class="col-12">
            {% include 'partials/_form_actions.html' with save_text='Save Purchase' %}
            <span class="text-muted small">Posting happens via API (/noc-purchases/{id}/post_purchase/).</span>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Recent NOC Purchases</h5>
      </div>
      <div class="card-body">
        <table class="table table-sm">
          <thead>
            <tr><th>Date</th><th>Bill</th><th>Qty (MT)</th><th>Total</th><th>Status</th></tr>
          </thead>
          <tbody>
            {% for p in purchases %}
              <tr>
                <td>{{ p.date }}</td>
                <td>{{ p.bill_no }}</td>
                <td>{{ p.quantity_mt }}</td>
                <td>{{ p.total_amount }}</td>
                <td>{{ p.get_status_display }}</td>
              </tr>
            {% empty %}
              <tr><td colspan="5" class="text-muted">No purchases yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
